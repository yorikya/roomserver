{{ template "header.html" . }}
<div class="view" style="background-image: url('/static/roomhtml/Home.jpeg'); background-repeat: no-repeat; background-size: cover; background-position: center center;">
    <div class="row">
        <div style=" color:#000000; border: 4px solid 	#F5F5F5 ; border-radius: 25px;" class="col-md-12">
            .col-md-12
        </div>
    </div>
    <div class="row">
        <div style=" color:#000000; border: 4px solid 	#F5F5F5 ; border-radius: 25px;" class="col-md-6">
            <div class="text-center"><u><h1>Temperature</h1></u></div>
            </br>
            <div class="text-center">
                <img src="/static/roomhtml/Temperture.png" class="rounded mx-auto d-block" alt="Responsive image">
            </div>
            <div class="text-center" id="{{.DHTTemperture}}">{{.DHTSensorTempertureHTML}}</div>
            </br>

        </div>
        <div style="color:#000000; border: 4px solid 	#F5F5F5; border-radius: 25px;" class="col-md-6">
            <div class="text-center"><u><h1>Humidity</h1></u></div>
                </br>
                <div class="text-center">
                    <img src="/static/roomhtml/Humuduty.png" class="rounded mx-auto d-block" alt="Responsive image">
                </div>
                
                <div class="text-center" id="{{.DHTHumuditi}}" >{{.DHTSensorHumudutyHTML}}</div>     
                </br> 
        </div>
        
    </div>
    <div class="row">  
        <div  style="color:#000000; border: 4px solid 	#F5F5F5; border-radius: 25px;" class="col-md-6">
                <div class="text-center"><u><h1>RGB Strip</h1></u></div>
                </br>
                <div class="text-left" id="{{.RGBName}}">
                    {{.RGBStripHTML}}
                </div>
            </br>
                <label for="RGBColor tag">RGB Tag</label>
                <select class="form-control" id="rgb_strip">
                    {{range .RGBOptions}}
                        <option name="{{.}}">{{.}}</option>
                    {{end}}
                </select>
                
                </br>
                </br> 
                <div class="text-left">
                    <button onclick="sendRGB()" type="submit" class="btn btn-primary">Send</button>
                </div>
            </br> 
            
            </br>
        </div>

        <div style="color:#000000; border: 4px solid 	#F5F5F5; border-radius: 25px;" class="col-md-6">
            <div class="text-center"><u><h1>Air Conditioner</h1></u></div>
            </br>

            <div class="text-left" id="{{.ACName}}">
                {{.ACStatusHTML}}
            </div>

            </br>

            <label for="AC mode">Mode</label>
            <select class="form-control" id="ac_mode">
                {{range .ACModeOptions}}
                    <option name="{{.}}">{{.}}</option>
                {{end}}
            </select>
            </br>
            <label for="AC temp" >Temp</label>
            <select class="form-control" id="ac_temp">
                {{range .ACTempertureOptions}}
                    <option name="{{.}}">{{.}}</option>
                {{end}}
            </select>
            </br>
                <button onclick="sendAC()" type="submit" class="btn btn-primary">Send</button>
        </div>
    </div>

    <div class="row">
        <div style=" color:#000000; border: 4px solid 	#F5F5F5; border-radius: 25px;" class="col-md-6">
            <div class="text-center"><u><h1>Camera</h1></u></div>
            </br>
            <div class="text-center">
                <img src="/static/roomhtml/NoSignal.jpeg" class="img-fluid" alt="Responsive image">
            </div>
            <div class="text-center" id="{{.CameraID}}">{{.CameraStatus}}</div>
            </br>
        </div>
    </div>
</div>
   
   <script>
    //    SensorFMT //
        function formatSensor(style, val) {
            var sensorFmtLst = "{{.SensorFMT}}".split("%s");  //"<h2 class='%s'>%s</h2>"
            return sensorFmtLst[0] + style + sensorFmtLst[1] + val + sensorFmtLst[2];
        }

       //Websocket connection
        if (window["WebSocket"]) {
            conn = new WebSocket("ws://" + document.location.host + "/ws");
            conn.onclose = function (evt) {
                console.log("close connection", evt);
            };
            conn.onmessage = function (evt) {
                var messages = evt.data.split("/"); // ["room1_main","update", "dht_Temperture","text-success","43.4"]
                console.log("the message ", messages);
                var roomID = messages[0];
                if (roomID === "{{.RoomID}}") {
                    var action = messages[1];
                    switch(action) {
                    case "update":   //                        text style            value
                        $("#"+ messages[2]).html(formatSensor(messages[3],messages[4]));
                        break;
                    default:
                        console.log("unknown action", action);                
                    }

                } 
                
            };
            conn.onerror = function(event) {
                console.log("WebSocket error observed:", event);
            };
            console.log("connect to web socket", conn);
        } else {
            
            console.log("brouser npt accept web soccets");
        }
        
        var rgb_strip = $( "#rgb_strip" );
        var ac_mode = $( "#ac_mode" );
        var ac_temp = $( "#ac_temp" );

        function sendRGB() {
            var url = "/action?roomid={{.RoomID}}&deviceid={{.RGBName}}&action=" + rgb_strip.val();
            $.get(url , function( data ) {
                    // alert( "Data Loaded: " + data );
            });
            
        }   

        function sendAC() {
            var url = "/action?roomid={{.RoomID}}&deviceid={{.ACName}}&action=" + ac_mode.val()+"_"+ac_temp.val();
            $.get(url , function( data ) {
                    // alert( "Data Loaded: " + data );
            });
            
        }   
   </script>
{{ template "footer.html" . }}